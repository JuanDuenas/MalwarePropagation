
package co.edu.uptc.Logic;

import co.edu.uptc.Model.Device;
import co.edu.uptc.Presentation.JFEditGraph;
import org.graphstream.graph.Edge;
import org.graphstream.graph.Graph;
import org.graphstream.graph.Node;
import org.graphstream.graph.implementations.MultiGraph;
import org.graphstream.graph.implementations.SingleGraph;

/**
 *
 * @author juanp
 */
public class NetworkGenerator {

    private Node servA;
    private Node servB;
    private Node servC;
    private Node rout1;
    private Node rout2;
    private Node rout3;
    private Node rout4;

    private Node pc1, pc2, pc3, pc4, pc5, pc6, pc7, pc8, pc9, pc10, pc11, pc12, pc13, pc14, pc15, pc16;

    private Edge e1, e2, e3, e4, e5, e6, e7, e8, e9, e10, e11, e12, e13, e14, e15,
            e16, e17, e18, e19, e20, e21, e22, e23, e24, e25, e26, e27, e28, e29, e30,
            e31, e32, e33, e34, e35, e36, e37, e38, e39, e40, e41, e42, e43, e44, e45,
            e46, e47, e48, e49;

    private Graph network;
    private NetworkHandling netHand;

    public NetworkGenerator() {

        network = new MultiGraph("Network");

        netHand = new NetworkHandling();

        servA = network.addNode("ServA");
        servB = network.addNode("ServB");
        servC = network.addNode("ServC");

        configServer();

        rout1 = network.addNode("Router1");
        rout2 = network.addNode("Router2");
        rout3 = network.addNode("Router3");
        rout4 = network.addNode("Router4");

        configRouter();

        pc1 = network.addNode("PC1");
        pc2 = network.addNode("PC2");
        pc3 = network.addNode("PC3");
        pc4 = network.addNode("PC4");
        pc5 = network.addNode("PC5");
        pc6 = network.addNode("PC6");
        pc7 = network.addNode("PC7");
        pc8 = network.addNode("PC8");
        pc9 = network.addNode("PC9");
        pc10 = network.addNode("PC10");
        pc11 = network.addNode("PC11");
        pc12 = network.addNode("PC12");
        pc13 = network.addNode("PC13");
        pc14 = network.addNode("PC14");
        pc15 = network.addNode("PC15");
        pc16 = network.addNode("PC16");

        configPC();

        generateAsociation("firewallEvasion");
    }

    private void configServer() {
        servA.setAttribute("Device", netHand.generateAttributes("ServA", "Server", true, false, true));
        servA.setAttribute("ui.label", "SERVIDOR A");
        servA.setAttribute("ui.style", "fill-color: rgb(193, 0, 255);");

        servB.setAttribute("Device", netHand.generateAttributes("ServB", "Server", true, true, false));
        servB.setAttribute("ui.label", "SERVIDOR B");
        servB.setAttribute("ui.style", "fill-color: rgb(193, 0, 255);");

        servC.setAttribute("Device", netHand.generateAttributes("ServC", "Server", false, false, true));
        servC.setAttribute("ui.label", "SERVIDOR C");
        servC.setAttribute("ui.style", "fill-color: rgb(193, 0, 255);");
    }

    private void configRouter() {
        rout1.setAttribute("Device", netHand.generateAttributes("Router1", "Router", true, true, true));
        rout1.setAttribute("ui.label", "ROUTER 1");
        rout1.setAttribute("ui.style", "fill-color: rgb(255, 215, 0);");
        rout2.setAttribute("Device", netHand.generateAttributes("Router2", "Router", false, false, false));
        rout2.setAttribute("ui.label", "ROUTER 2");
        rout2.setAttribute("ui.style", "fill-color: rgb(255, 215, 0);");
        rout3.setAttribute("Device", netHand.generateAttributes("Router3", "Router", true, false, true));
        rout3.setAttribute("ui.label", "ROUTER 3");
        rout3.setAttribute("ui.style", "fill-color: rgb(255, 215, 0);");
        rout4.setAttribute("Device", netHand.generateAttributes("Router4", "Router", true, false, true));
        rout4.setAttribute("ui.label", "ROUTER 4");
        rout4.setAttribute("ui.style", "fill-color: rgb(255, 215, 0);");
    }

    private void configPC() {
        pc1.setAttribute("Device", netHand.generateAttributes("PC1", "Computadora", true, false, true));
        pc1.setAttribute("ui.label", "PC 1");
        pc1.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc2.setAttribute("Device", netHand.generateAttributes("PC2", "Computadora", true, false, true));
        pc2.setAttribute("ui.label", "PC 2");
        pc2.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc3.setAttribute("Device", netHand.generateAttributes("PC3", "Computadora", true, true, false));
        pc3.setAttribute("ui.label", "PC 3");
        pc3.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc4.setAttribute("Device", netHand.generateAttributes("PC4", "Computadora", false, true, true));
        pc4.setAttribute("ui.label", "PC 4");
        pc4.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc5.setAttribute("Device", netHand.generateAttributes("PC5", "Computadora", true, false, true));
        pc5.setAttribute("ui.label", "PC 5");
        pc5.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc6.setAttribute("Device", netHand.generateAttributes("PC6", "Computadora", false, true, false));
        pc6.setAttribute("ui.label", "PC 6");
        pc6.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc7.setAttribute("Device", netHand.generateAttributes("PC7", "Computadora", true, false, true));
        pc7.setAttribute("ui.label", "PC 7");
        pc7.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc8.setAttribute("Device", netHand.generateAttributes("PC8", "Computadora", false, false, true));
        pc8.setAttribute("ui.label", "PC 8");
        pc8.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc9.setAttribute("Device", netHand.generateAttributes("PC9", "Computadora", true, true, true));
        pc9.setAttribute("ui.label", "PC 9");
        pc9.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc10.setAttribute("Device", netHand.generateAttributes("PC10", "Computadora", false, false, true));
        pc10.setAttribute("ui.label", "PC 10");
        pc10.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc11.setAttribute("Device", netHand.generateAttributes("PC11", "Computadora", false, true, false));
        pc11.setAttribute("ui.label", "PC 11");
        pc11.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc12.setAttribute("Device", netHand.generateAttributes("PC12", "Computadora", false, false, true));
        pc12.setAttribute("ui.label", "PC 12");
        pc12.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc13.setAttribute("Device", netHand.generateAttributes("PC13", "Computadora", true, false, true));
        pc13.setAttribute("ui.label", "PC 13");
        pc13.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc14.setAttribute("Device", netHand.generateAttributes("PC14", "Computadora", true, false, false));
        pc14.setAttribute("ui.label", "PC 14");
        pc14.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc15.setAttribute("Device", netHand.generateAttributes("PC15", "Computadora", false, true, true));
        pc15.setAttribute("ui.label", "PC 15");
        pc15.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
        pc16.setAttribute("Device", netHand.generateAttributes("PC16", "Computadora", true, true, false));
        pc16.setAttribute("ui.label", "PC 16");
        pc16.setAttribute("ui.style", "fill-color: rgb(0, 112, 255);");
    }

    public Graph getNetwork() {
        return network;
    }

    private void generateAsociation(String malwareType) {
        e1 = network.addEdge("sA-r1", "ServA", "Router1");

        e2 = network.addEdge("r1-sA", "Router1", "ServA");

        e3 = network.addEdge("r1-c1", "Router1", "PC1");

        e4 = network.addEdge("c1-r1", "PC1", "Router1");

        e5 = network.addEdge("r1-c2", "Router1", "PC2");

        e6 = network.addEdge("r1-c3", "Router1", "PC3");

        e7 = network.addEdge("r1-c4", "Router1", "PC4");

        e8 = network.addEdge("c4-c5", "PC4", "PC5");

        e9 = network.addEdge("c4-c6", "PC4", "PC6");

        e10 = network.addEdge("c4-c7", "PC4", "PC7");

        e11 = network.addEdge("c4-c8", "PC4", "PC8");

        e12 = network.addEdge("c5-c4", "PC5", "PC4");

        e13 = network.addEdge("c5-c6", "PC5", "PC6");

        e14 = network.addEdge("c5-c7", "PC5", "PC7");

        e15 = network.addEdge("c5-c8", "PC5", "PC8");

        e16 = network.addEdge("c6-c4", "PC6", "PC4");

        e17 = network.addEdge("c6-c5", "PC6", "PC5");

        e18 = network.addEdge("c6-c7", "PC6", "PC7");

        e19 = network.addEdge("c6-c9", "PC6", "PC8");

        e20 = network.addEdge("c7-c4", "PC7", "PC4");

        e21 = network.addEdge("c7-c5", "PC7", "PC5");

        e22 = network.addEdge("c7-c6", "PC7", "PC6");

        e23 = network.addEdge("c7-c8", "PC7", "PC8");

        e24 = network.addEdge("c8-c4", "PC8", "PC4");

        e25 = network.addEdge("c8-c5", "PC8", "PC5");

        e26 = network.addEdge("c8-c6", "PC8", "PC6");

        e27 = network.addEdge("c8-c7", "PC8", "PC7");

        e28 = network.addEdge("c8-sB", "PC8", "ServB");

        e29 = network.addEdge("sB-c4", "ServB", "PC4");

        e30 = network.addEdge("sB-r2", "ServB", "Router2");

        e31 = network.addEdge("r2-sB", "Router2", "ServB");

        e32 = network.addEdge("r2-sA", "Router2", "ServA");

        e33 = network.addEdge("sA-r2", "ServA", "Router2");

        e34 = network.addEdge("r2-c9", "Router2", "PC9");

        e35 = network.addEdge("c9-r2", "PC9", "Router2");

        e36 = network.addEdge("c9-c12", "PC9", "PC12");

        e37 = network.addEdge("c12-c11", "PC12", "PC11");

        e38 = network.addEdge("c11-c10", "PC11", "PC10");

        e39 = network.addEdge("c10-c9", "PC10", "PC9");

        e40 = network.addEdge("c8-sC", "PC8", "ServC");

        e41 = network.addEdge("sC-r3", "ServC", "Router3");

        e42 = network.addEdge("r3-c12", "Router3", "PC12");

        e43 = network.addEdge("r3-c13", "Router3", "PC13");

        e44 = network.addEdge("r3-c14", "Router3", "PC14");

        e45 = network.addEdge("r3-c15", "Router3", "PC15");

        e46 = network.addEdge("c14-c15", "PC14", "PC15");

        e47 = network.addEdge("c15-r4", "PC15", "Router4");

        e48 = network.addEdge("sC-r4", "ServC", "Router4");

        e49 = network.addEdge("r4-16", "Router4", "PC16");

        setWeight(malwareType);
    }

    public void setWeight(String malwareType) {
        e1.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout1.getAttribute("Device")));
        e1.setAttribute("ui.label", e1.getAttribute("weight"));

        e2.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) servA.getAttribute("Device")));
        e2.setAttribute("ui.label", e2.getAttribute("weight"));

        e3.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc1.getAttribute("Device")));
        e3.setAttribute("ui.label", e3.getAttribute("weight"));

        e4.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout1.getAttribute("Device")));
        e4.setAttribute("ui.label", e4.getAttribute("weight"));

        e5.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc2.getAttribute("Device")));
        e5.setAttribute("ui.label", e5.getAttribute("weight"));

        e6.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc3.getAttribute("Device")));
        e6.setAttribute("ui.label", e6.getAttribute("weight"));

        e7.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e7.setAttribute("ui.label", e7.getAttribute("weight"));

        e8.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc5.getAttribute("Device")));
        e8.setAttribute("ui.label", e8.getAttribute("weight"));

        e9.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc6.getAttribute("Device")));
        e9.setAttribute("ui.label", e9.getAttribute("weight"));

        e10.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc7.getAttribute("Device")));
        e10.setAttribute("ui.label", e10.getAttribute("weight"));

        e11.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc8.getAttribute("Device")));
        e11.setAttribute("ui.label", e11.getAttribute("weight"));

        e12.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e12.setAttribute("ui.label", e12.getAttribute("weight"));

        e13.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc6.getAttribute("Device")));
        e13.setAttribute("ui.label", e13.getAttribute("weight"));

        e14.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc7.getAttribute("Device")));
        e14.setAttribute("ui.label", e14.getAttribute("weight"));

        e15.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc8.getAttribute("Device")));
        e15.setAttribute("ui.label", e15.getAttribute("weight"));

        e16.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e16.setAttribute("ui.label", e16.getAttribute("weight"));

        e17.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc5.getAttribute("Device")));
        e17.setAttribute("ui.label", e17.getAttribute("weight"));

        e18.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc7.getAttribute("Device")));
        e18.setAttribute("ui.label", e18.getAttribute("weight"));

        e19.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc8.getAttribute("Device")));
        e19.setAttribute("ui.label", e19.getAttribute("weight"));

        e20.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e20.setAttribute("ui.label", e20.getAttribute("weight"));

        e21.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc5.getAttribute("Device")));
        e21.setAttribute("ui.label", e21.getAttribute("weight"));

        e22.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc6.getAttribute("Device")));
        e22.setAttribute("ui.label", e22.getAttribute("weight"));

        e23.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc7.getAttribute("Device")));
        e23.setAttribute("ui.label", e23.getAttribute("weight"));

        e24.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e24.setAttribute("ui.label", e24.getAttribute("weight"));

        e25.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc5.getAttribute("Device")));
        e25.setAttribute("ui.label", e25.getAttribute("weight"));

        e26.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc6.getAttribute("Device")));
        e26.setAttribute("ui.label", e26.getAttribute("weight"));

        e27.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc7.getAttribute("Device")));
        e27.setAttribute("ui.label", e27.getAttribute("weight"));

        e28.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) servB.getAttribute("Device")));
        e28.setAttribute("ui.label", e28.getAttribute("weight"));

        e29.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc4.getAttribute("Device")));
        e29.setAttribute("ui.label", e29.getAttribute("weight"));

        e30.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout2.getAttribute("Device")));
        e30.setAttribute("ui.label", e30.getAttribute("weight"));

        e31.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) servB.getAttribute("Device")));
        e31.setAttribute("ui.label", e31.getAttribute("weight"));

        e32.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) servA.getAttribute("Device")));
        e32.setAttribute("ui.label", e32.getAttribute("weight"));

        e33.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout2.getAttribute("Device")));
        e33.setAttribute("ui.label", e33.getAttribute("weight"));

        e34.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc9.getAttribute("Device")));
        e34.setAttribute("ui.label", e34.getAttribute("weight"));

        e35.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout2.getAttribute("Device")));
        e35.setAttribute("ui.label", e35.getAttribute("weight"));

        e36.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc12.getAttribute("Device")));
        e36.setAttribute("ui.label", e36.getAttribute("weight"));

        e37.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc11.getAttribute("Device")));
        e37.setAttribute("ui.label", e37.getAttribute("weight"));

        e38.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc10.getAttribute("Device")));
        e38.setAttribute("ui.label", e38.getAttribute("weight"));

        e39.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc9.getAttribute("Device")));
        e39.setAttribute("ui.label", e39.getAttribute("weight"));

        e40.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) servC.getAttribute("Device")));
        e40.setAttribute("ui.label", e40.getAttribute("weight"));

        e41.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout3.getAttribute("Device")));
        e41.setAttribute("ui.label", e41.getAttribute("weight"));

        e42.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc12.getAttribute("Device")));
        e42.setAttribute("ui.label", e42.getAttribute("weight"));

        e43.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc13.getAttribute("Device")));
        e43.setAttribute("ui.label", e43.getAttribute("weight"));

        e44.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc14.getAttribute("Device")));
        e44.setAttribute("ui.label", e44.getAttribute("weight"));

        e45.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc15.getAttribute("Device")));
        e45.setAttribute("ui.label", e45.getAttribute("weight"));

        e46.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc15.getAttribute("Device")));
        e46.setAttribute("ui.label", e46.getAttribute("weight"));

        e47.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout4.getAttribute("Device")));
        e47.setAttribute("ui.label", e47.getAttribute("weight"));

        e48.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) rout4.getAttribute("Device")));
        e48.setAttribute("ui.label", e48.getAttribute("weight"));

        e49.setAttribute("weight", netHand.calculateWeight(malwareType, (Device) pc16.getAttribute("Device")));
        e49.setAttribute("ui.label", e49.getAttribute("weight"));
    }

    public Graph getGraph() {
        return network;
    }

    public NetworkHandling getNetHand() {
        return netHand;
    }

}
