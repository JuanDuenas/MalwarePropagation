/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package co.edu.uptc.Logic;
import co.edu.uptc.Model.Device;
import org.graphstream.algorithm.Dijkstra;
import org.graphstream.graph.*;
import org.graphstream.graph.implementations.*;
import org.graphstream.ui.view.Viewer;
/**
 *
 * @author juanp
 */
public class NetworkHandling {
     
    public Device generateAttributes(String name, String type, boolean firewall,boolean WPA, boolean SSL) {
       int speed = (int) (Math.random() * 1000);
       Device dev = new Device(name, type, firewall, WPA, SSL, speed);
       return dev;
    }
    
    public double calculateWeight(String malwareType, Device a){
        double aWeight = 0.0;
        
        if(malwareType.equals("fastConnection")) {
            if(!a.isSSL()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(!a.isFirewallUpdated()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(!a.isWPA3()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(a.getType().equals("Computadora")){
                aWeight = aWeight + 2;
            }
            if(a.getType().equals("Router")){
                aWeight++;
            }
            if(a.getConnectionSpeed() == 0) {
                aWeight = aWeight + 10;
            }
            if(a.getConnectionSpeed() > 0 && a.getConnectionSpeed() <= 10){
                aWeight = aWeight + 4;
            } else if (a.getConnectionSpeed() > 10 && a.getConnectionSpeed() <= 100){
                aWeight ++;
            }
        }
        if(malwareType.equals("insecureConnection")) {
            if(a.isSSL()){
                aWeight = aWeight + 5;
            }
            if(!a.isFirewallUpdated()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(a.isWPA3()){
                aWeight = aWeight + 5;
            }
            if(a.getType().equals("Computadora")){
                aWeight = aWeight + 2;
            }
            if(a.getType().equals("Router")){
                aWeight++;
            }
            if(a.getConnectionSpeed() == 0) {
                aWeight = aWeight + 10;
            }
            if(a.getConnectionSpeed() > 0 && a.getConnectionSpeed() <= 10){
                aWeight = aWeight + 6;
            } else if (a.getConnectionSpeed() > 10 && a.getConnectionSpeed() <= 100){
                aWeight = aWeight + 3;
            } else if (a.getConnectionSpeed() < 100) {
                aWeight++ ;
            }  
        }
        if(malwareType.equals("firewallEvasion")) {
             if(!a.isSSL()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(!a.isFirewallUpdated()){
                aWeight = aWeight + 3;
            }
            if(!a.isWPA3()){
                aWeight ++;
            } else {
                aWeight = aWeight + 5;
            }
            if(a.getType().equals("Computadora")){
                aWeight = aWeight + 2;
            }
            if(a.getType().equals("Router")){
                aWeight++;
            }
            if(a.getConnectionSpeed() == 0) {
                aWeight = aWeight + 10;
            }
            if(a.getConnectionSpeed() > 0 && a.getConnectionSpeed() <= 10){
                aWeight = aWeight + 6;
            } else if (a.getConnectionSpeed() > 10 && a.getConnectionSpeed() <= 100){
                aWeight = aWeight + 3;
            } else if (a.getConnectionSpeed() < 100) {
                aWeight++ ;
            }  
        }
        System.out.println("Peso: " + aWeight);
        return aWeight;
    }

    public void algorithmDijkstra(NetworkGenerator ng) {
        Dijkstra dijkstra = new Dijkstra(Dijkstra.Element.EDGE, null, "weight");
        
        dijkstra.init(ng.getGraph());
        
        dijkstra.setSource(ng.getGraph().getNode("PC1"));
        
        dijkstra.compute();
        
        double length = dijkstra.getPathLength(ng.getGraph().getNode("PC9"));
        System.out.println("Longitud del camino mÃ¡s corto: " + length);
         
        Path shortestPath = dijkstra.getPath(ng.getGraph().getNode("PC9"));
         for (Edge edge : shortestPath.getEdgePath()) {
            edge.setAttribute("ui.style", "fill-color: red;");
        }
        for (Node node : shortestPath.getNodePath()) {
            node.setAttribute("ui.style", "fill-color: red;");
        }
    }
}
